import{t as L,r as h,ac as W,c as Y,x as j,k as g,o as t,y as C,z as o,T as l,A as w,au as J,W as s,Y as i,m as V,n as c,a0 as b,a1 as x,V as Q,B as a,U as X,b as Z,a7 as ee,a8 as oe,_ as se}from"./userStore-DI58VgZ6.js";import{P as ae}from"./index-bkhK2U3_.js";import{u as te,a as le,b as ne}from"./Btn-2hiIT76k.js";import{k as re,u as ie,c as ue}from"./app-Dh_3ddLE.js";import{u as ce}from"./useModal-DVUoJGRd.js";import{u as de}from"./useSmartPlaylistForm-COXtAFBI.js";import{m as me}from"./index-Dvdk0smA.js";import{_ as pe}from"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import{_ as k}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import{S as _e}from"./SelectBox-CnkytuoA.js";import"./common-Qp7bRr50.js";import"./index-BBRRzm9T.js";import"./SoundBars-BQEuboqd.js";import"./usePlaylistManagement-BYa-nJNx.js";import"./downloadService-C6bGKWwx.js";import"./index-SJV2sFs2.js";const P=d=>(ee("data-v-7121c00c"),d=d(),oe(),d),fe=["onSubmit","onKeydown"],ve=P(()=>l("header",null,[l("h1",null,"New Smart Playlist")],-1)),ye={class:"space-y-5"},he=P(()=>l("option",{value:null},null,-1)),we=["value"],ke={class:"group-container space-y-5 overflow-auto max-h-[480px]"},Se={key:0,class:"form-row"},ge={class:"text-k-text-secondary"},Ce=L({__name:"CreateSmartPlaylistForm",emits:["close"],setup(d,{emit:B}){const{Btn:_,FormBase:I,RuleGroup:D,collectedRuleGroups:f,addGroup:N,onGroupChanged:F}=de(),{showOverlay:G,hideOverlay:O}=re(),{toastSuccess:$}=te(),{showConfirmDialog:K}=le(),{go:R}=ie(),{isPlus:U}=ue(),n=ce().getFromContext("folder"),m=h(""),p=h(n==null?void 0:n.id),E=W(Y.state,"folders"),v=h(!1),y=()=>B("close"),M=()=>m.value===""&&p.value===(n==null?void 0:n.id)&&f.value.length===0,S=async()=>{if(M()){y();return}await K("Discard all changes?")&&y()},T=async()=>{G();try{const u=await Z.store(m.value,{rules:f.value,folder_id:p.value,own_songs_only:v.value});y(),$(`Playlist "${u.name}" created.`),R(`playlist/${u.id}`)}catch(u){ne("dialog").handleHttpError(u)}finally{O()}};return(u,r)=>{const A=j("Icon"),H=g("koel-focus"),q=g("koel-overflow-fade");return t(),C(a(I),null,{default:o(()=>[l("form",{onSubmit:w(T,["prevent"]),onKeydown:J(S,["esc"])},[ve,l("main",ye,[s(k,{cols:2},{default:o(()=>[s(k,null,{label:o(()=>[i("Name")]),default:o(()=>[V(s(pe,{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=e=>m.value=e),name:"name",placeholder:"Playlist name",required:""},null,8,["modelValue"]),[[H]])]),_:1}),s(k,null,{label:o(()=>[i("Folder")]),default:o(()=>[s(_e,{modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=e=>p.value=e)},{default:o(()=>[he,(t(!0),c(b,null,x(E.value,e=>(t(),c("option",{key:e.id,value:e.id},Q(e.name),9,we))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),V((t(),c("div",ke,[(t(!0),c(b,null,x(a(f),(e,z)=>(t(),C(a(D),{key:e.id,group:e,"is-first-group":z===0,onInput:a(F)},null,8,["group","is-first-group","onInput"]))),128)),s(a(_),{class:"btn-add-group",small:"",success:"",title:"Add a new group",uppercase:"",onClick:w(a(N),["prevent"])},{default:o(()=>[s(A,{icon:a(ae)},null,8,["icon"]),i(" Group ")]),_:1},8,["onClick"])])),[[q]]),a(U)?(t(),c("div",Se,[l("label",ge,[s(me,{modelValue:v.value,"onUpdate:modelValue":r[2]||(r[2]=e=>v.value=e)},null,8,["modelValue"]),i(" Only include songs from my own library ")])])):X("",!0)]),l("footer",null,[s(a(_),{type:"submit"},{default:o(()=>[i("Save")]),_:1}),s(a(_),{class:"btn-cancel",white:"",onClick:w(S,["prevent"])},{default:o(()=>[i("Cancel")]),_:1},8,["onClick"])])],40,fe)]),_:1})}}}),Me=se(Ce,[["__scopeId","data-v-7121c00c"]]);export{Me as default};
