import{t as V,r as f,o as n,n as S,W as e,z as r,T as i,Y as C,A as b,ae as P,B as y,aj as D,m as L,aa as F,y as k,U as x,X as G,l as I,a7 as M,a8 as N,_ as T}from"./userStore-DI58VgZ6.js";import{_ as U}from"./logo-DCyVV1bg.js";import{b as q,u as O,B as E}from"./Btn-2hiIT76k.js";import{_ as A}from"./PasswordField.vue_vue_type_script_setup_true_lang-Bm6xCQKi.js";import{_ as $}from"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import{_ as g}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import{g as z}from"./google-KJUKpri4.js";import"./index-BBRRzm9T.js";const j=["onSubmit"],H=i("h1",{class:"text-2xl mb-4"},"Forgot Password",-1),W={class:"flex flex-col gap-3 sm:flex-row sm:gap-0 sm:content-stretch"},Y=V({__name:"ForgotPasswordForm",emits:["cancel"],setup(d,{emit:l}){const{handleHttpError:c}=q(),{toastSuccess:o}=O(),s=f(""),t=f(!1),u=()=>{s.value="",l("cancel")},m=async()=>{try{t.value=!0,await P.requestResetPasswordLink(s.value),o("Password reset link sent. Please check your email.")}catch(a){c(a,{404:"No user with this email address found."})}finally{t.value=!1}};return(a,w)=>(n(),S("form",{class:"min-w-full sm:min-w-[480px] sm:bg-white/10 p-7 rounded-xl","data-testid":"forgot-password-form",onSubmit:b(m,["prevent"])},[H,e(g,null,{default:r(()=>[i("div",W,[e($,{modelValue:s.value,"onUpdate:modelValue":w[0]||(w[0]=v=>s.value=v),class:"flex-1 sm:rounded-l sm:rounded-r-none",placeholder:"Your email address",required:"",type:"email"},null,8,["modelValue"]),e(E,{disabled:t.value,class:"sm:rounded-l-none sm:rounded-r",type:"submit"},{default:r(()=>[C("Reset Password")]),_:1},8,["disabled"]),e(E,{disabled:t.value,class:"!text-k-text-secondary",transparent:"",onClick:u},{default:r(()=>[C("Cancel")]),_:1},8,["disabled"])])]),_:1})],40,j))}}),K=["onClick"],X=["src"],J=V({__name:"GoogleLoginButton",emits:["success","error"],setup(d,{emit:l}){const c=async()=>{try{window.onmessage=o=>l("success",o.data),D("/auth/google/redirect","Google Login",768,640,window)}catch(o){l("error",o)}};return(o,s)=>(n(),S("button",{class:"opacity-50 hover:opacity-100",title:"Log in with Google",type:"button",onClick:b(c,["prevent"])},[i("img",{src:y(z),alt:"Google Logo",height:"32",width:"32"},null,8,X)],8,K))}}),Q=d=>(M("data-v-619d688f"),d=d(),N(),d),Z={class:"flex items-center justify-center min-h-screen my-0 mx-auto flex-col gap-5"},ee=["onSubmit"],oe=Q(()=>i("div",{class:"text-center mb-8"},[i("img",{alt:"Koel's logo",class:"inline-block",src:U,width:"156"})],-1)),se=["onClick"],te={key:0,class:"flex gap-3 items-center"},ae=!0,re=V({__name:"LoginForm",emits:["loggedin"],setup(d,{emit:l}){const c={email:"demo@koel.dev",password:"demo"},o=window.MAILER_CONFIGURED&&!window.IS_DEMO,s=window.SSO_PROVIDERS||[],t=f(window.IS_DEMO?c.email:"admin@admin"),u=f(window.IS_DEMO?c.password:"admin"),m=f(!1),a=f(!1),w=()=>a.value=!0,v=async()=>{try{await P.login(t.value,u.value),m.value=!1,u.value="",l("loggedin")}catch(_){m.value=!0,I.error(_),window.setTimeout(()=>m.value=!1,2e3)}};ae&&v();const B=_=>{I.error("SSO error: ",_),O().toastError("Login failed. Please try again.")},R=_=>{P.setTokensUsingCompositeToken(_),l("loggedin")};return(_,p)=>(n(),S("div",Z,[L(i("form",{class:G([{error:m.value},"w-full sm:w-[288px] sm:border duration-500 p-7 rounded-xl border-transparent sm:bg-white/10 space-y-3"]),"data-testid":"login-form",onSubmit:b(v,["prevent"])},[oe,e(g,null,{default:r(()=>[e($,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=h=>t.value=h),autofocus:"",placeholder:"Email Address",required:"",type:"email"},null,8,["modelValue"])]),_:1}),e(g,null,{default:r(()=>[e(A,{modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=h=>u.value=h),placeholder:"Password",required:""},null,8,["modelValue"])]),_:1}),e(g,null,{default:r(()=>[e(E,{"data-testid":"submit",type:"submit"},{default:r(()=>[C("Log In")]),_:1})]),_:1}),y(o)?(n(),k(g,{key:0},{default:r(()=>[i("a",{class:"text-right text-[.95rem] text-k-text-secondary",role:"button",onClick:b(w,["prevent"])}," Forgot password? ",8,se)]),_:1})):x("",!0)],42,ee),[[F,!a.value]]),y(s).length?L((n(),S("div",te,[y(s).includes("Google")?(n(),k(J,{key:0,onError:B,onSuccess:R})):x("",!0)],512)),[[F,!a.value]]):x("",!0),a.value?(n(),k(Y,{key:1,onCancel:p[2]||(p[2]=h=>a.value=!1)})):x("",!0)]))}}),pe=T(re,[["__scopeId","data-v-619d688f"]]);export{pe as default};
