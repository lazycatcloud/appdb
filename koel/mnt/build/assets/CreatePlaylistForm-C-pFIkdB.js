import{t as E,r as h,ac as K,c as M,h as O,at as U,k as z,o as m,n as d,T as n,Y as l,B as f,V as w,p as F,U as H,W as t,z as e,m as R,a0 as q,a1 as A,A as b,au as I,b as L}from"./userStore-DI58VgZ6.js";import{u as W,a as Y,B as C,b as j}from"./Btn-2hiIT76k.js";import{u as G}from"./useModal-DVUoJGRd.js";import{k as J,u as Q}from"./app-Dh_3ddLE.js";import{_ as X}from"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import{_ as y}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import{S as Z}from"./SelectBox-CnkytuoA.js";import"./index-bkhK2U3_.js";import"./common-Qp7bRr50.js";import"./index-BBRRzm9T.js";const ee=["onSubmit","onKeydown"],ae={key:0,class:"text-k-text-secondary","data-testid":"from-playables"},te=n("option",{value:null},null,-1),se=["value"],ye=E({__name:"CreatePlaylistForm",emits:["close"],setup(oe,{emit:g}){const{showOverlay:k,hideOverlay:V}=J(),{toastSuccess:x}=W(),{showConfirmDialog:S}=Y(),{go:B}=Q(),{getFromContext:_}=G(),s=_("folder")??null,r=_("playables")??[],i=h(s==null?void 0:s.id),u=h(""),D=K(M.state,"folders"),p=()=>g("close"),N=O(()=>{switch(U(r)){case"songs":return"song";case"episodes":return"song";default:return"item"}}),P=async()=>{k();try{const o=await L.store(u.value,{folder_id:i.value},r);p(),x(`Playlist "${o.name}" created.`),B(`playlist/${o.id}`)}catch(o){j("dialog").handleHttpError(o)}finally{V()}},T=()=>u.value.trim()===""&&i.value===(s==null?void 0:s.id),v=async()=>{if(T()){p();return}await S("Discard all changes?")&&p()};return(o,c)=>{const $=z("koel-focus");return m(),d("form",{class:"md:w-[480px] w-full",onSubmit:b(P,["prevent"]),onKeydown:I(v,["esc"])},[n("header",null,[n("h1",null,[l(" New Playlist "),f(r).length?(m(),d("span",ae," from "+w(f(F)(f(r),N.value)),1)):H("",!0)])]),n("main",null,[t(y,{cols:2},{default:e(()=>[t(y,null,{label:e(()=>[l("Name")]),default:e(()=>[R(t(X,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=a=>u.value=a),name:"name",placeholder:"Playlist name",required:""},null,8,["modelValue"]),[[$]])]),_:1}),t(y,null,{label:e(()=>[l("Folder")]),default:e(()=>[t(Z,{modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=a=>i.value=a)},{default:e(()=>[te,(m(!0),d(q,null,A(D.value,a=>(m(),d("option",{key:a.id,value:a.id},w(a.name),9,se))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),n("footer",null,[t(C,{type:"submit"},{default:e(()=>[l("Save")]),_:1}),t(C,{white:"",onClick:b(v,["prevent"])},{default:e(()=>[l("Cancel")]),_:1},8,["onClick"])])],40,ee)}}});export{ye as default};
