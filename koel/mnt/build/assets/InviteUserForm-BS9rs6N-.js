import{t as x,r as p,w as S,o as $,n as A,T as r,W as a,z as i,Y as n,A as y,au as I}from"./userStore-DI58VgZ6.js";import{i as O}from"./invitationService-DTH8jUK0.js";import{u as T,a as U,B as g,b as D}from"./Btn-2hiIT76k.js";import{k as K}from"./app-Dh_3ddLE.js";import{_ as N}from"./TooltipIcon.vue_vue_type_script_setup_true_lang-CwCHTPax.js";import{m as H}from"./index-Dvdk0smA.js";import{_ as M}from"./TextArea.vue_vue_type_script_setup_true_lang-BLs5UbW_.js";import{_ as w}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import"./index-bkhK2U3_.js";import"./common-Qp7bRr50.js";import"./index-BBRRzm9T.js";import"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import"./usePlaylistManagement-BYa-nJNx.js";import"./downloadService-C6bGKWwx.js";import"./SoundBars-BQEuboqd.js";import"./index-SJV2sFs2.js";const q=["onSubmit","onKeydown"],z=r("header",null,[r("h1",null,"Invite Users")],-1),F={class:"space-y-5"},P={class:"text-base"},ne=x({__name:"InviteUserForm",emits:["close"],setup(W,{emit:V}){const{showOverlay:E,hideOverlay:b}=K(),{toastSuccess:k}=T(),{showConfirmDialog:C}=U(),o=p(),d=p(""),m=p(!1);let s=[];S(d,t=>{s=t.trim().split(`
`).map(e=>e.trim()).filter(Boolean),s=[...new Set(s)]});const B=async()=>{var l,v,_,h;const t=[],e=document.createElement("input");if(e.type="email",s.forEach(u=>{e.value=u,e.checkValidity()&&t.push(u)}),t.length!==s.length){(l=o.value.el)==null||l.setCustomValidity("One or some of the emails you entered are invalid."),(v=o.value.el)==null||v.reportValidity();return}if(t.length===0){(_=o.value.el)==null||_.setCustomValidity("Please enter at least one email address."),(h=o.value.el)==null||h.reportValidity();return}E();try{await O.invite(t,m.value),k(`Invitation${t.length===1?"":"s"} sent.`),c()}catch(u){D("dialog").handleHttpError(u)}finally{b()}},c=()=>V("close"),f=async()=>{if(s.length===0&&!m.value){c();return}await C("Discard all changes?")&&c()};return(t,e)=>($(),A("form",{novalidate:"",onSubmit:y(B,["prevent"]),onKeydown:I(f,["esc"])},[z,r("main",F,[a(w,null,{label:i(()=>[n("Emails")]),help:i(()=>[n("To invite multiple users, input one email per line.")]),default:i(()=>[a(M,{ref_key:"emailsEl",ref:o,modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),class:"!min-h-[8rem]",name:"emails",required:"",title:"Emails"},null,8,["modelValue"])]),_:1}),a(w,null,{default:i(()=>[r("div",P,[a(H,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),name:"is_admin"},null,8,["modelValue"]),n(" Admin role "),a(N,{title:"Admins can perform administrative tasks like managing users and uploading songs."})])]),_:1})]),r("footer",null,[a(g,{class:"btn-add",type:"submit"},{default:i(()=>[n("Invite")]),_:1}),a(g,{class:"btn-cancel",white:"",onClick:y(f,["prevent"])},{default:i(()=>[n("Cancel")]),_:1},8,["onClick"])])],40,q))}});export{ne as default};
