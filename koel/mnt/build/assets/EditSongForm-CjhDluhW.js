import{t as K,r as W,a3 as q,h as S,k as Y,o as k,n as v,T as c,B as i,X as C,V as P,W as t,z as a,Y as n,y as V,U as R,m as f,a0 as X,a1 as Q,aa as D,A as w,au as Z,O as ee,s as ae,p as te,f as le,_ as se}from"./userStore-DI58VgZ6.js";import{d as x}from"./common-Qp7bRr50.js";import{u as oe,a as ne,B as E,b as re}from"./Btn-2hiIT76k.js";import{u as ie}from"./useModal-DVUoJGRd.js";import{k as ue}from"./app-Dh_3ddLE.js";import{_ as m}from"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import{_ as de}from"./TextArea.vue_vue_type_script_setup_true_lang-BLs5UbW_.js";import{_ as r}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import{a as ce,_ as F,b as me,c as M,T as pe}from"./Tabs-D6rBcrC1.js";import"./index-bkhK2U3_.js";import"./index-BBRRzm9T.js";const be=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz & Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alternative Rock","Bass","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native US","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore Techno","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","SynthPop","Abstract","Art Rock","Baroque","Bhangra","Big beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie-Rock","G-Funk","Dubstep","Garage Rock","Psybient"],_e=["onSubmit","onKeydown"],ke={class:"gap-4"},ye=["src"],ge={class:"flex-1 flex flex-col justify-center overflow-hidden"},fe={id:"genres"},he=["value"],Se=K({__name:"EditSongForm",emits:["close"],setup(ve,{emit:N}){const{showOverlay:G,hideOverlay:U}=ue(),{toastSuccess:L}=oe(),{showConfirmDialog:H}=ne(),{getFromContext:T}=ie(),o=T("songs"),b=W(T("initialTab")),u=o.length===1,p=u?"":"Leave unchanged",d=_=>u?!0:new Set(o.map(l=>l[_])).size===1,g=d("artist_name"),y=d("album_id"),z=y?o[0].album_cover||x:x,e=q({title:d("title")?o[0].title:"",album_name:y?o[0].album_name:"",artist_name:g?o[0].artist_name:"",album_artist_name:"",lyrics:u?o[0].lyrics:"",track:d("track")&&o[0].track!==0?o[0].track:null,disc:d("disc")&&o[0].disc!==0?o[0].disc:null,year:d("year")?o[0].year:null,genre:d("genre")?o[0].genre:""});y&&g&&o[0].album_artist_id===o[0].artist_id?e.album_artist_name="":e.album_artist_name=d("album_artist_name")?o[0].album_artist_name:"",u||(delete e.title,delete e.lyrics);const I=Object.assign({},e),O=S(()=>u?e.title:`${o.length} songs selected`),$=S(()=>g||e.artist_name?e.artist_name:"Mixed Artists"),J=S(()=>y||e.album_name?e.album_name:"Mixed Albums"),h=()=>N("close"),B=async()=>{if(ee.isEqual(e,I)){h();return}await H("Discard all changes?")&&h()},j=async()=>{G();try{const _=await ae.update(o,e);L(`Updated ${te(o,"song")}.`),le.emit("SONGS_UPDATED",_),h()}catch(_){re("dialog").handleHttpError(_)}finally{U()}};return(_,l)=>{const A=Y("koel-focus");return k(),v("form",{class:"max-w-[540px]",onSubmit:w(j,["prevent"]),onKeydown:Z(B,["esc"])},[c("header",ke,[c("img",{src:i(z),alt:"",class:"w-[84px] aspect-square object-cover object-center rounded-md"},null,8,ye),c("div",ge,[c("h1",{class:C({mixed:!u})},P(O.value),3),c("h2",{class:C({mixed:!i(g)&&!e.artist_name}),"data-testid":"displayed-artist-name"},P($.value),3),c("h2",{class:C({mixed:!i(y)&&!e.album_name}),"data-testid":"displayed-album-name"},P(J.value),3)])]),t(pe,{class:"mt-4"},{default:a(()=>[t(ce,null,{default:a(()=>[t(F,{id:"editSongTabDetails",selected:b.value==="details","aria-controls":"editSongPanelDetails",onClick:l[0]||(l[0]=s=>b.value="details")},{default:a(()=>[n(" Details ")]),_:1},8,["selected"]),u?(k(),V(F,{key:0,id:"editSongTabLyrics",selected:b.value==="lyrics","aria-controls":"editSongPanelLyrics","data-testid":"edit-song-lyrics-tab",onClick:l[1]||(l[1]=s=>b.value="lyrics")},{default:a(()=>[n(" Lyrics ")]),_:1},8,["selected"])):R("",!0)]),_:1}),t(me,null,{default:a(()=>[f(t(M,{id:"editSongPanelDetails","aria-labelledby":"editSongTabDetails",class:"space-y-5"},{default:a(()=>[u?(k(),V(r,{key:0},{label:a(()=>[n("Title")]),default:a(()=>[f(t(m,{modelValue:e.title,"onUpdate:modelValue":l[2]||(l[2]=s=>e.title=s),"data-testid":"title-input",name:"title",title:"Title"},null,8,["modelValue"]),[[A]])]),_:1})):R("",!0),t(r,{cols:2},{default:a(()=>[t(r,null,{label:a(()=>[n("Artist")]),default:a(()=>[t(m,{modelValue:e.artist_name,"onUpdate:modelValue":l[3]||(l[3]=s=>e.artist_name=s),placeholder:i(p),"data-testid":"artist-input",name:"artist"},null,8,["modelValue","placeholder"])]),_:1}),t(r,null,{label:a(()=>[n("Album Artist")]),default:a(()=>[t(m,{modelValue:e.album_artist_name,"onUpdate:modelValue":l[4]||(l[4]=s=>e.album_artist_name=s),placeholder:i(p),"data-testid":"albumArtist-input",name:"album_artist"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),t(r,null,{label:a(()=>[n("Album")]),default:a(()=>[t(m,{modelValue:e.album_name,"onUpdate:modelValue":l[5]||(l[5]=s=>e.album_name=s),placeholder:i(p),"data-testid":"album-input",name:"album"},null,8,["modelValue","placeholder"])]),_:1}),t(r,{cols:2},{default:a(()=>[t(r,null,{label:a(()=>[n("Track")]),default:a(()=>[t(m,{modelValue:e.track,"onUpdate:modelValue":l[6]||(l[6]=s=>e.track=s),placeholder:i(p),"data-testid":"track-input",min:"1",name:"track",type:"number"},null,8,["modelValue","placeholder"])]),_:1}),t(r,null,{label:a(()=>[n("Disc")]),default:a(()=>[t(m,{modelValue:e.disc,"onUpdate:modelValue":l[7]||(l[7]=s=>e.disc=s),placeholder:i(p),"data-testid":"disc-input",min:"1",name:"disc",type:"number"},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),t(r,{cols:2},{default:a(()=>[t(r,null,{label:a(()=>[n("Genre")]),default:a(()=>[t(m,{modelValue:e.genre,"onUpdate:modelValue":l[8]||(l[8]=s=>e.genre=s),placeholder:i(p),"data-testid":"genre-input",list:"genres",name:"genre"},null,8,["modelValue","placeholder"]),c("datalist",fe,[(k(!0),v(X,null,Q(i(be),s=>(k(),v("option",{key:s,value:s},null,8,he))),128))])]),_:1}),t(r,null,{label:a(()=>[n("Year")]),default:a(()=>[t(m,{modelValue:e.year,"onUpdate:modelValue":l[9]||(l[9]=s=>e.year=s),placeholder:i(p),"data-testid":"year-input",name:"year",type:"number"},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1},512),[[D,b.value==="details"]]),u?f((k(),V(M,{key:0,id:"editSongPanelLyrics","aria-labelledby":"editSongTabLyrics"},{default:a(()=>[t(r,null,{default:a(()=>[f(t(de,{modelValue:e.lyrics,"onUpdate:modelValue":l[10]||(l[10]=s=>e.lyrics=s),"data-testid":"lyrics-input",name:"lyrics",title:"Lyrics"},null,8,["modelValue"]),[[A]])]),_:1})]),_:1},512)),[[D,b.value==="lyrics"]]):R("",!0)]),_:1})]),_:1}),c("footer",null,[t(E,{type:"submit"},{default:a(()=>[n("Update")]),_:1}),t(E,{class:"btn-cancel",white:"",onClick:w(B,["prevent"])},{default:a(()=>[n("Cancel")]),_:1},8,["onClick"])])],40,_e)}}}),Fe=se(Se,[["__scopeId","data-v-78e54941"]]);export{Fe as default};
