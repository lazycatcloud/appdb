import{t as C,w as E,a3 as D,k as S,o as p,n as N,T as n,B as e,y,z as s,Y as r,V as O,U as w,W as o,m as A,A as h,au as M,Q as T,O as $}from"./userStore-DI58VgZ6.js";import{u as q,a as K,B as b,b as F}from"./Btn-2hiIT76k.js";import{u as H}from"./useModal-DVUoJGRd.js";import{k as P}from"./app-Dh_3ddLE.js";import{_ as j}from"./TooltipIcon.vue_vue_type_script_setup_true_lang-CwCHTPax.js";import{m as z}from"./index-Dvdk0smA.js";import{A as L}from"./AlertBox-D4FMxXub.js";import{_ as c}from"./TextInput.vue_vue_type_script_setup_true_lang-Cn7Fe5WG.js";import{_ as m}from"./FormRow.vue_vue_type_script_setup_true_lang-jRw1p4cD.js";import"./index-bkhK2U3_.js";import"./common-Qp7bRr50.js";import"./index-BBRRzm9T.js";import"./usePlaylistManagement-BYa-nJNx.js";import"./downloadService-C6bGKWwx.js";import"./SoundBars-BQEuboqd.js";import"./index-SJV2sFs2.js";const Q=["onSubmit","onKeydown"],W=n("header",null,[n("h1",null,"Edit User")],-1),Y={class:"space-y-5"},G=n("br",null,null,-1),pe=C({__name:"EditUserForm",emits:["close"],setup(I,{emit:v}){const{showOverlay:V,hideOverlay:g}=P(),{toastSuccess:k}=q(),{showConfirmDialog:U}=K(),t=H().getFromContext("user");let d,a;E(t,()=>{d={name:t.name,email:t.email,is_admin:t.is_admin},a=D(Object.assign({},d))},{immediate:!0});const x=async()=>{V();try{await T.update(t,a),k("User profile updated."),u()}catch(_){F("dialog").handleHttpError(_)}finally{g()}},u=()=>v("close"),f=async()=>{if($.isEqual(d,a)){u();return}await U("Discard all changes?")&&u()};return(_,l)=>{const B=S("koel-focus");return p(),N("form",{"data-testid":"edit-user-form",onSubmit:h(x,["prevent"]),onKeydown:M(f,["esc"])},[W,n("main",Y,[e(t).sso_provider?(p(),y(L,{key:0,type:"info"},{default:s(()=>[r(" This user logs in via SSO by "+O(e(t).sso_provider)+".",1),G]),_:1})):w("",!0),o(m,null,{label:s(()=>[r("Name")]),default:s(()=>[A(o(c,{modelValue:e(a).name,"onUpdate:modelValue":l[0]||(l[0]=i=>e(a).name=i),name:"name",required:"",title:"Name"},null,8,["modelValue"]),[[B]])]),_:1}),o(m,null,{label:s(()=>[r("Email")]),default:s(()=>[o(c,{modelValue:e(a).email,"onUpdate:modelValue":l[1]||(l[1]=i=>e(a).email=i),readonly:e(t).sso_provider,name:"email",required:"",title:"Email",type:"email"},null,8,["modelValue","readonly"])]),_:1}),e(t).sso_provider?w("",!0):(p(),y(m,{key:1},{label:s(()=>[r("Password")]),help:s(()=>[r("Min. 10 characters. Should be a mix of characters, numbers, and symbols.")]),default:s(()=>[o(c,{modelValue:e(a).password,"onUpdate:modelValue":l[2]||(l[2]=i=>e(a).password=i),autocomplete:"new-password",name:"password",placeholder:"Leave blank for no changes",title:"Password",type:"password"},null,8,["modelValue"])]),_:1})),o(m,null,{default:s(()=>[n("div",null,[o(z,{modelValue:e(a).is_admin,"onUpdate:modelValue":l[3]||(l[3]=i=>e(a).is_admin=i),name:"is_admin"},null,8,["modelValue"]),r(" User is an admin "),o(j,{title:"Admins can perform administrative tasks like managing users and uploading songs."})])]),_:1})]),n("footer",null,[o(b,{class:"btn-update",type:"submit"},{default:s(()=>[r("Update")]),_:1}),o(b,{class:"btn-cancel",white:"",onClick:h(f,["prevent"])},{default:s(()=>[r("Cancel")]),_:1},8,["onClick"])])],40,Q)}}});export{pe as default};
