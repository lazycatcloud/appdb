import{t as k,a9 as B,v as N,r as a,f as w,k as O,o as b,y as T,z as M,m as R,n as A,X as S,B as C,A as $,au as D,T as V,q as X,Y as q,U as K,ad as p,l as L,_ as P}from"./userStore-DI58VgZ6.js";import{O as U}from"./index-SJV2sFs2.js";const z=["onKeydown"],H=k({__name:"ContextMenu",props:{extraClass:{}},setup(l,{expose:v}){const c=l;B(e=>({"016129a4":u.value,"2ac04198":y.value,"2611ddbb":h.value,fb4a405c:x.value,"7b08b900":_.value}));const{extraClass:f}=N(c),t=a(),n=a(!1),u=a("0"),y=a("0"),g=async(e,s=!1)=>{var r;const{bottom:o,right:d}=e.getBoundingClientRect();o>window.innerHeight?(e.style.top="auto",e.style.bottom="0"):e.style.bottom="auto",d>window.innerWidth?(e.style.right=s?`${(r=t.value)==null?void 0:r.getBoundingClientRect().width}px`:"0",e.style.left="auto"):e.style.right="auto"},x=a("0px"),h=a("0px"),_=a("0 0, 0 0, 0 0, 0 0"),m=()=>{var e;(e=t.value)==null||e.querySelectorAll(".has-sub").forEach(s=>{const o=s.querySelector(".submenu");!o||s.eventsRegistered||(s.addEventListener("mouseenter",async()=>{o.style.display="block",await p(),await g(o,!0)}),s.addEventListener("mousemove",async d=>{await p();const r=o.getBoundingClientRect();x.value=r.height+"px",h.value=r.x-d.clientX+"px",_.value=`polygon(100% 0, 0 ${d.clientY-r.top}px, 100% 100%)`}),s.addEventListener("mouseleave",()=>{o.style.top="0",o.style.bottom="auto",o.style.display="none"}),s.eventsRegistered=!0)})},E=async(e=0,s=0)=>{u.value=`${e}px`,y.value=`${s}px`,n.value=!0,await p();try{await g(t.value),m()}catch(o){L.error(o)}w.emit("CONTEXT_MENU_OPENED",t.value)},i=()=>n.value=!1;return w.on("CONTEXT_MENU_OPENED",e=>e===t.value||i()),v({open:E,close:i,shown:n}),(e,s)=>{const o=O("koel-focus");return b(),T(C(U),{onTrigger:i},{default:M(()=>[n.value?R((b(),A("nav",{key:0,ref_key:"el",ref:t,class:S([C(f),"menu context-menu select-none shadow"]),tabindex:"0",onContextmenu:s[0]||(s[0]=$(()=>{},["prevent"])),onKeydown:D(i,["esc"])},[V("ul",null,[X(e.$slots,"default",{},()=>[q("Menu items go here.")],!0)])],42,z)),[[o]]):K("",!0)]),_:3})}}}),W=P(H,[["__scopeId","data-v-614b12b3"]]),j=()=>{const l=a(),v=async(t,n)=>{var u;return await((u=l.value)==null?void 0:u.open(t,n))},c=()=>{var t;return(t=l.value)==null?void 0:t.close()};return{ContextMenu:W,base:l,open:v,close:c,trigger:t=>{c(),t()}}};export{j as u};
